---
import clsx from "clsx";
import { getRestProps } from "../../utils";
import Icon from "../Icon/index.astro";
import { buttonSchema } from "./schema";

const props = buttonSchema.parse(Astro.props);
const restProps = getRestProps(Astro.props, buttonSchema);

const Tag = props.link ? "a" : "button";

const classNames = clsx(
  "button",
  `text-${props.size}`,
  `type-${props.type}`,
  props.layout !== "normal" && `layout-${props.layout}`,
  props.outline && "outline",
  props.hideText && "icon-only",
  props.disabled && "disabled",
  props.className
);

const actions = props.link
  ? { href: props.link, role: "button" }
  : { type: "button", disabled: props.disabled };

// Set up data attribute for CSS-based icon positioning
const iconData = props.icon?.position ? { "data-icon-position": props.icon.position } : {};
---

<style>
  @import "./styles.pcss";
</style>

<Tag
  {...actions}
  {...restProps}
  {...iconData}
  class:list={classNames}
  style={props.customStyle}
  id={props.id}
  aria-label={props.aria?.label}
  aria-describedby={props.aria?.describedBy}
  aria-controls={props.aria?.controls}
  aria-expanded={props.aria?.expanded}
>
  {props.icon?.name && <Icon name={props.icon.name} buttonIcon size="none" class="button-icon" />}

  {props.label && <span class:list={props.hideText ? "sr-only" : "label"}>{props.label}</span>}
</Tag>
